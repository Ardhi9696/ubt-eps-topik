<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      .audio-control {
        margin-bottom: 10px;
      }
    </style>
    <title>Batas Pemutaran Audio Satu Kali</title>
  </head>
  <body>
    <audio id="audio1" class="audio-control" src="Audio/Soal-1/soal-1.mp3" onended="audioEnded('audio1')"></audio>
    <button class="playButton" data-audio="audio1" onclick="playAudio('audio1')">Putar Audio 1</button>
    <button class="resetButton" onclick="resetAudio('audio1')">Reset Audio 1</button>

    <audio id="audio2" class="audio-control" src="Audio/Soal-2/1.mp3" onended="audioEnded('audio2')"></audio>
    <button class="playButton" data-audio="audio2" onclick="playAudio('audio2')">Putar Audio 2</button>
    <button class="resetButton" onclick="resetAudio('audio2')">Reset Audio 2</button>

    <audio id="audio3" class="audio-control" src="Audio/Soal-3/1.mp3" onended="audioEnded('audio3')"></audio>
    <button class="playButton" data-audio="audio3" onclick="playAudio('audio3')">Putar Audio 3</button>
    <button class="resetButton" onclick="resetAudio('audio3')">Reset Audio 3</button>

    <!-- Tambahkan audio, tombol, dan fungsi reset lain sesuai kebutuhan -->

    <script>
      // Inisialisasi objek untuk melacak status pemutaran masing-masing audio
      var audioStatus = {};

      function playAudio(audioId) {
        // Cek apakah audio sedang diputar
        if (!audioStatus[audioId]) {
          // Lakukan tindakan atau logika pemutaran audio di sini
          console.log('Audio ' + audioId + ' belum diputar.');

          // Nonaktifkan tombol setelah audio selesai
          document.querySelector('.playButton[data-audio="' + audioId + '"]').disabled = true;

          // Mulai pemutaran audio
          var audioElement = document.getElementById(audioId);
          audioElement.play();

          // Tambahkan event listener untuk menangani ketika audio selesai diputar
          audioElement.addEventListener('ended', function () {
            audioEnded(audioId);
          });

          // Setel status pemutaran untuk audio tertentu
          audioStatus[audioId] = true;

          // Nonaktifkan tombol pemutaran audio lainnya
          disableOtherPlayButtons(audioId);

          // Simpan status pemutaran ke localStorage
          localStorage.setItem('audioStatus', JSON.stringify(audioStatus));
        } else {
          console.log('Audio ' + audioId + ' sudah diputar.');
        }
      }

      function resetAudio(audioId) {
        // Hapus status pemutaran untuk audio tertentu dari localStorage
        delete audioStatus[audioId];

        // Aktifkan kembali tombol pemutaran
        document.querySelector('.playButton[data-audio="' + audioId + '"]').disabled = false;

        // Aktifkan kembali tombol pemutaran audio lainnya
        enableAllPlayButtons();

        // Simpan status pemutaran yang diperbarui ke localStorage
        localStorage.setItem('audioStatus', JSON.stringify(audioStatus));
      }

      function resetAllAudio() {
        // Hapus status pemutaran untuk semua audio dari localStorage
        audioStatus = {};

        // Aktifkan kembali tombol pemutaran untuk semua audio
        enableAllPlayButtons();

        // Simpan status pemutaran yang diperbarui ke localStorage
        localStorage.setItem('audioStatus', JSON.stringify(audioStatus));
      }

      // Fungsi yang akan dipanggil ketika audio selesai diputar
      function audioEnded(audioId) {
        console.log('Audio ' + audioId + ' selesai diputar.');

        // Tambahkan logika atau tindakan setelah audio selesai diputar

        // Aktifkan kembali tombol pemutaran audio lainnya
        enableAllPlayButtons();
      }

      // Fungsi untuk menonaktifkan tombol pemutaran audio lainnya
      function disableOtherPlayButtons(currentAudioId) {
        var playButtons = document.querySelectorAll('.playButton');
        playButtons.forEach(function (button) {
          var buttonAudioId = button.getAttribute('data-audio');
          if (buttonAudioId !== currentAudioId) {
            button.disabled = true;
          }
        });
      }

      // Fungsi untuk mengaktifkan kembali semua tombol pemutaran audio
      function enableAllPlayButtons() {
        var playButtons = document.querySelectorAll('.playButton');
        playButtons.forEach(function (button) {
          button.disabled = false;
        });
      }

      // Cek status pemutaran dari localStorage saat halaman dimuat
      document.addEventListener('DOMContentLoaded', function () {
        var storedAudioStatus = localStorage.getItem('audioStatus');
        if (storedAudioStatus) {
          audioStatus = JSON.parse(storedAudioStatus);

          // Nonaktifkan tombol untuk audio yang sudah diputar
          for (var audioId in audioStatus) {
            if (audioStatus[audioId]) {
              document.querySelector('.playButton[data-audio="' + audioId + '"]').disabled = true;
              console.log('Audio ' + audioId + ' sudah diputar.');
            }
          }
        }
      });
    </script>
  </body>
</html>
